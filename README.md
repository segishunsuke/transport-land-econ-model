# 交通インフラ供給におけるの土地投入を考慮したWider Economic Impacts (WEIs)の分析モデル

本リポジトリは、交通インフラ供給における土地投入の制約と交通混雑を考慮した都市経済モデルを用いて、間接的波及便益（Wider Economic Impacts: WEIs）を理論的・定量的に分析するための数値シミュレーションコードを公開するものです。

## フォルダ構成とファイル概要

`Codes/` フォルダには以下のプログラムが含まれています。

- **`model_simulation.py`**: 
  都市経済モデルの数値シミュレーションを行うメインスクリプトです。一都市および複数都市モデルにおける空間均衡の算出、および社会的余剰を最大化する次善（Second Best）の便益評価率（$\delta_G$）の導出を行います。
  - **設定**: スクリプト冒頭の変数（`alpha`, `beta`, `gamma` 等）を書き換えることで、土地投入シェアや混雑弾力性などのパラメータを変更可能です。
  - **実行**: `if __name__ == "__main__":` ブロック内に、Second Bestの均衡解の算出などの基本的な実行例が記載されています。

- **`myoptimize.py`**: 
  本研究のために独自に開発した数値最適化ライブラリです。均衡条件の解法や余剰最大化問題の最適化に必要な、ニュートン法およびBFGS法等のアルゴリズムを含んでいます。

## 実行環境

- Python 3.x
- NumPy

## 使用方法

1. 本リポジトリをクローンまたはダウンロードします。
2. `Codes/` ディレクトリに移動します。
3. 以下のコマンドでシミュレーションを実行します。
   ```bash
   python model_simulation.py

# urban-transport-wei-model

本リポジトリは、交通インフラ整備における土地投入と交通混雑を考慮した都市経済モデルの数値シミュレーションコードを公開するものです。論文の本編および付録Bの分析結果を再現するためのプログラムが含まれています。

## フォルダ構成とファイル概要

`Codes/` フォルダ内に以下の Python スクリプトを配置しています。

- **`model_simulation.py`**: 
  本編の分析（Henderson型モデル）に用いるプログラムです。複数都市モデルにおける空間均衡の算出、次善（Second Best）の便益評価率 $\delta_G$ の算出などを行います。
  
- **`model_city_structure_simulation.py`**: 
  付録Bの分析（都市内構造を考慮した複数都市・複数ゾーンモデル）に用いるプログラムです。家計の居住地・就業地選択（ロジットモデル）を内生化した空間均衡、および、Second Bestの便益評価率 $\delta_G$ の算出を行います。

- **`myoptimize.py`**: 
  本研究のために作成した数値計算用ライブラリです。均衡条件の解法（ニュートン法）や社会的余剰の最大化（BFGS法）などの最適化アルゴリズムを提供します。

## 使用方法

### 1. パラメータの設定
各シミュレーションファイル（`model_simulation.py`, `model_city_structure_simulation.py`）の冒頭部分に、$\alpha, \beta, \gamma$ などの主要なパラメータ設定が記述されています。分析ケースに合わせて数値を変更してください。

### 2. 実行
各ファイル末尾の `if __name__ == "__main__":` ブロックに、基本的な実行例（均衡解の算出や結果の CSV 出力など）が記載されています。
以下のコマンドで実行可能です：

```bash
python model_simulation.py
# または
python model_city_structure_simulation.py
